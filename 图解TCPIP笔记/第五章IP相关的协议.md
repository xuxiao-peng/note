# 一 DNS

# 二 ARP

功能：通过 IP 地址查询对于的 MAC 地址（只适用于IPv4 IPv6中用ICMPv6代替）

## ARP工作机制

![1559184844626](C:\Users\P\Desktop\笔记本\img\计算机网络\ARP工作机制.png)

从一个 IP 地址发送 ARP 请求包以了解其 MAC 地址，目标地址将自己的 MAC 地址填入 ARP 响应返回到 IP 地址。

为了避免每次请求都发送 ARP 请求包，主机和目的主机都会把 MAC 地址和 IP 地址做映射存储下来 `arp -a`  系统查看命令。

为了避免 MAC 地址与 IP 地址的对应关系可能变化的情况（换网卡，笔记本电脑IP 不固定等情况）这个缓存是有过期时间的。

## IP 地址和 MAC 地址缺一不可

1、假如没有 IP 地址，只有 MAC 地址，那么我每发送一个包要告诉全世界我的包然后等他们去接收，造成巨大的溜了浪费

2、假如没有 MAC 地址，只有 IP 地址，那么 IP 地址通过广播的方式发送请求，会造成重复接受。**（有误）**

# 三 ICMP

## ICMP 的主要功能：

①确认 IP 包是否成功送达目标地址、②通知在发送过程中 IP 包被废弃的具体原因、③改善网络设置。

ICMP 包会以 IP 包进行发送

## ICMP 消息分类

![1559185733914](C:\Users\P\Desktop\笔记本\img\计算机网络\ICMP消息分类.png)

## 主要的 ICMP 消息

### ICMP 目标不可达消息

 IP 路由器无法将 IP 数据包发送给目标地址，会给发送端主机返回一个目标不可达的 ICMP 消息。

### ICMP 重定向消息

![1559186071565](C:\Users\P\Desktop\笔记本\img\计算机网络\ICMP重定向消息.png)

# 四 DHCP	

## 主要功能： 实现 IP 地址和子关掩码自动分配

## 工作机制：

首先假设一台 DHCP 服务器（一般有路由器充当），将DHCP 所有分配的 IP地址、子网掩码、理由控制信息、DNS 服务器等信息设置到服务器上。

DHCP 的工作分为两个阶段，

① DHCP 客户端（即我们请求分配IP 的主机）向同一网段的机器发送 DHCP 发现包，包中要求设置 iP 地址和子网掩码，DHCP 服务器收到之后返回发送端 DHCP 提供包（包中通知可以使用的网络设置）

② DHCP 客户端 发送DHCP 请求包（通知想要使用 DHCP 服务器中返回的 DHCP 网络设置）

DHCP 服务器通知允许使用上面的设置

![1559187057648](C:\Users\P\Desktop\笔记本\img\计算机网络\DHCP工作机制.png)

![1559187109311](C:\Users\P\Desktop\笔记本\img\计算机网络\DHCP客户端和DHCP服务端所必要的功能.png)

# 五 NAT

主要功能：实现一个公网IP 与多个内网IP 通信的技术。

## NAT 的工作机制

![1559193706724](C:\Users\P\Desktop\笔记本\img\计算机网络\NAT工作机制（一）)



![1559193739930](C:\Users\P\Desktop\笔记本\img\计算机网络\NAT工作机制（二）.png)

## NAT 潜在问题：

![1559193794232](C:\Users\P\Desktop\笔记本\img\计算机网络\NAT潜在问题)

# 六 IP隧道